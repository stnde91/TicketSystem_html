// Am Ende der index.html, vor </body> einf√ºgen:

<script>
// ====================================
// LOADING-SCREEN FIX
// ====================================

// Sofort nach DOM-Load ausf√ºhren
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing app...');
    
    // Loading-Screen nach 2 Sekunden ausblenden
    setTimeout(function() {
        hideLoadingScreen();
    }, 2000);
    
    // Backup: Bei Klick auf Loading-Screen
    const loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) {
        loadingScreen.addEventListener('click', function() {
            hideLoadingScreen();
        });
        
        // Hinweis-Text hinzuf√ºgen
        const hintText = document.createElement('p');
        hintText.textContent = 'Zum Fortfahren klicken...';
        hintText.style.marginTop = '20px';
        hintText.style.opacity = '0.8';
        hintText.style.fontSize = '14px';
        loadingScreen.appendChild(hintText);
    }
});

// Loading-Screen ausblenden und Login anzeigen
function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    const loginScreen = document.getElementById('loginScreen');
    
    if (loadingScreen) {
        loadingScreen.style.transition = 'opacity 0.5s ease';
        loadingScreen.style.opacity = '0';
        
        setTimeout(() => {
            loadingScreen.style.display = 'none';
            if (loginScreen) {
                loginScreen.style.display = 'flex';
                console.log('Login screen shown');
            }
        }, 500);
    }
}

// ====================================
// DEMO-BENUTZER FUNKTIONEN
// ====================================

// Demo-Benutzer Daten
const demoUsers = {
    admin: {
        email: 'admin@firma.de',
        password: 'admin123',
        name: 'Administrator',
        role: 'admin'
    },
    user: {
        email: 'max.schmidt@firma.de', 
        password: 'user123',
        name: 'Max Schmidt',
        role: 'user'
    },
    support: {
        email: 'anna.weber@firma.de',
        password: 'support123', 
        name: 'Anna Weber',
        role: 'support'
    }
};

// Demo-Benutzer Daten in Formular einf√ºllen
function fillDemoUser(userType) {
    const user = demoUsers[userType];
    if (user) {
        document.getElementById('email').value = user.email;
        document.getElementById('password').value = user.password;
        
        // Visuelles Feedback
        showNotification(`Demo-Benutzer geladen: ${user.name}`, 'info');
    }
}

// Login-Formular verarbeiten
document.addEventListener('DOMContentLoaded', function() {
    const loginForm = document.getElementById('loginForm');
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Demo-Login pr√ºfen
            const user = validateDemoLogin(email, password);
            if (user) {
                loginUser(user);
            } else {
                showNotification('‚ùå Ung√ºltige Anmeldedaten!', 'error');
            }
        });
    }
});

// Demo-Login validieren
function validateDemoLogin(email, password) {
    for (const [key, user] of Object.entries(demoUsers)) {
        if (user.email === email && user.password === password) {
            return user;
        }
    }
    return null;
}

// Benutzer anmelden
function loginUser(user) {
    showNotification(`‚úÖ Willkommen ${user.name}!`, 'success');
    
    // Benutzer-Daten speichern
    sessionStorage.setItem('currentUser', JSON.stringify(user));
    
    // UI nach 1 Sekunde umschalten
    setTimeout(() => {
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('mainApp').classList.add('active');
        
        // Benutzer-Interface aktualisieren
        updateUserInterface(user);
    }, 1000);
}

// Gast-Login
function guestLogin() {
    const guestUser = {
        email: 'gast@demo.de',
        name: 'Gast-Benutzer',
        role: 'guest'
    };
    
    showNotification('üîç Gast-Modus aktiviert (nur ansehen)', 'info');
    loginUser(guestUser);
}

// Benutzer-Interface aktualisieren
function updateUserInterface(user) {
    // Header aktualisieren
    document.getElementById('userName').textContent = user.name;
    document.getElementById('userEmail').textContent = user.email;
    document.getElementById('userAvatar').textContent = user.name.charAt(0).toUpperCase();
    
    // Rolle anzeigen
    const roleText = {
        'admin': 'üëë Administrator',
        'user': 'üë§ Mitarbeiter', 
        'support': 'üõ†Ô∏è Support',
        'guest': 'üëÅÔ∏è Gast'
    };
    document.getElementById('userRole').textContent = roleText[user.role] || 'üë§ Benutzer';
    
    // Admin-Tab anzeigen falls berechtigt
    if (user.role === 'admin') {
        const adminElements = document.querySelectorAll('.admin-only');
        adminElements.forEach(el => el.style.display = 'block');
    }
    
    console.log(`User ${user.name} logged in with role: ${user.role}`);
}

// Abmelden
function logout() {
    sessionStorage.removeItem('currentUser');
    showNotification('üëã Erfolgreich abgemeldet', 'info');
    
    setTimeout(() => {
        window.location.reload();
    }, 1000);
}

// Tab-Navigation
function showTab(tabName) {
    // Alle Tabs ausblenden
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
    
    // Gew√§hlten Tab anzeigen
    const targetTab = document.getElementById(tabName + '-tab');
    if (targetTab) {
        targetTab.classList.add('active');
    }
    
    // Aktiven Nav-Tab markieren
    const clickedTab = event ? event.target : document.querySelector(`[onclick="showTab('${tabName}')"]`);
    if (clickedTab) {
        clickedTab.classList.add('active');
    }
}

// Teams-Integration testen
function testTeamsIntegration() {
    showNotification('üì¢ Teams-Integration wird getestet...', 'info');
    
    // Simuliere Teams-Nachricht
    setTimeout(() => {
        showNotification('‚úÖ Teams-Test erfolgreich! (Simuliert)', 'success');
    }, 2000);
}

// Benachrichtigungen anzeigen
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    const icon = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
    notification.innerHTML = `
        <div style="font-weight: 600; margin-bottom: 4px;">
            ${icon} ${type === 'error' ? 'Fehler' : type === 'success' ? 'Erfolg' : 'Information'}
        </div>
        <div style="font-size: 14px;">${message}</div>
    `;
    
    document.body.appendChild(notification);
    
    // Animation
    setTimeout(() => notification.classList.add('show'), 100);
    
    // Auto-remove
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
    }, type === 'error' ? 6000 : 3000);
}

// Debug-Information
console.log('üé´ Ticket System Pro - Prototyp geladen');
console.log('Demo-Benutzer verf√ºgbar:', Object.keys(demoUsers));
</script>